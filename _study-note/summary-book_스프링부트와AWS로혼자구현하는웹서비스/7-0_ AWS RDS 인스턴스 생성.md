# 7. AWS RDS

> ### 백엔드가 왜 DB를?
>
> 웹 서비스 백엔드에서, **어플리케이션 코드 작성만큼 중요한 것이 DB 다루는 일**  
> 물론, 큰규모 회사엔 대용량/대량의 데이터를 다루기에 DB만 담당하는 DBA라는 담당자가 있지만, 그러한 이유는 전문성이 필요한 것 때문이다.  
> 스타트업/소규모 서비스에선 **개발자가 DB를 알고, 다룰수 있어야 함**

## 1. RDS?

직접 DB를 설치하면, *'모니터링, 알람, 백업, HA 구성등'* 을 모두 직접 해야된다. (처음 구축시 며칠 걸릴 수 있음)  
-> AWS에선 위의 작업들을 모두 지원하는 **관리형 서비스, RDS(Relational Database Service)** 를 제공

RDS의 특징은,
- **클라우드 기반의 관계형 DB(=RDB)** 
- 운영 작업(하드웨어 프로비저닝, DB 설정, 패치 및 백업)을 자동화 -> 개발자는 개발에 집중 가능
- **조정 가능한 용량** 지원 -> 예상 외 데이터로 용량이 넘쳐도, 비용만 내면 정상 이용 가능

## 2. RDS 인스턴스 생성

1. 검색창에 rds 검색
2. rds 대시보드 > **[데이터베이스 생성]** 클릭

하면 RDS 생성 과정이 진행된다. 차례대로 선택하며 진행하자.

1. 데이터베이스 생성 방식 선택

    **표준 생성** 그대로 선택  
    (손쉬운 생성은 DB엔진만 골라 인스턴스 생성 뒤, 추가로 설정을 변경 가능)
    
2. 엔진 옵션

    본인이 쓰는거 아니면, **MariaDB** 선택
    
    > ### DB 엔진, MariaDB를 추천하는 이유
    >
    > RDS에는 *'오라클, MSSQL, PostgreSQL, MySQL, MariaDB, Amazon 오로라'* 등이 있다.
      특정 DB를 쓸 이유가 없다면, **MySQL, MariaDB, PostgreSQL** 를 추천하고, 그중에 **MariaDB** 추천
    >
    > **MariaDB** 쓰는 이유
    > 1. 가격 : RDS 가격은 라이센스 비용 영향 받음 
    >
    >   오픈소스인 MySQl, MariaDB, PostgreSQL가 오라클, MSSQL보다 같은 사양대비 가격 높음
    > 
    > 2. Amazon Aurora(오로라) 교체 용이성
    >
    >   AWS 오로라 : AWS에서 **MySQL, PostgreSQL을 클라우드 기반에 맞게 재구성한 DB**   
       -> RDS MySQL 대비 5배, RDS PostgreSQL 대비 3배 성능 제공 + AWS에서 직접 엔지니어링  
       (근데 AWS 오로라를 직접 쓰기엔, 프리티어 대상 아니며, 최소 월 10만원 이상이라... 일단 MariaDB로 하다 나중에 오로라로 이전)
    
    > ### MariaDB란?
    > 
    > 국내외 가장 인기있는 오픈소스 DB = MySQL (단순 쿼리 처리 성능이 압도적, 오래 사용되어 성능/신뢰성 꾸준히 개선)  
      MySQL이 합병되면서 개발자들이 떠나와 본인만의 프로젝트를 진행하게 됨  
      -> MySQL 창시자가 만든 프로젝트 = **MariaDB (MySQL 기반)**
    > 
    > - MySQL과 쿼리같은 전반적인 사용법 유사
    > - 동일 HW 사양에서 MySQL보다 향상된 성능
    > - 좀 더 활성화된 커뮤니티
    > - 다양한 기능, 스토리지 엔진

3. 템플릿

    **프리티어** 선택  
    (*정보* 링크를 클릭하면, 프리티어에 대한 정보를 볼 수 있음)
        
        단일 AZ db.t2.micro 인스턴스에서 Amazon RDS의 750시간
        20GB의 범용 스토리지(SSD)
        20GB의 자동 백업 스토리지 및 사용자가 시작한 모든 DB 스냅샷
 
4. 설정

    - DB 인스턴스 식별자 : 본인만의 DB 인스턴스 이름을 등록
    - 마스터 사용자 이름, 마스터 암호 : 본인 사용자 정보를 등록(여기서 쓰는 사용자 정보로 실제 DB에 접근하니 어디다 메모해주면 좋음)
     
5. DB 인스턴스 크기

    프리티어는 선택할 거 없이 그대로 기본값

6. 스토리지

    20GiB으로 설정  
    
    > ### 스토리지 자동 조정?
    > 
    > **처리량 급증해 DB 여유공간 없을때 , 자동으로 스토리지 확장하는 기능**
    > 
    > Auto scaling라는 것이 실제 스토리지 사용량을 모니터링 해주어 후에 자동으로 스토리지를 확장해줌  
      -> 활성화해서 추가비용은 없음
    >
    > **최대 스토리지 임계값** : 해당 DB 인스턴스가 자동으로 어디까지 확장될지 제한값

7. 가용성 및 내구성 설정

    파스(pass)
    
8. 연결 (VPC 설정)

    퍼블릭 엑세스 기능을 **예**로 변경 (그래야 외부에서도 DB 접속 가능)  
    -> 이후 보안 그룹에서 지정된 IP만 접근 가능하게 설정할 꺼임

9. 추가구성 (접혀져있는 항목)
    **초기 데이터베이스 이름을 지정** : 지정 안하면 aws rds에서 DB를 생성하지 않는다!!
    
    ![image](https://user-images.githubusercontent.com/48408417/110427001-66c7ba00-80ea-11eb-8db7-0723deebc2be.png)
    
    중요하게 생각 안하고 넘겼더니, 나중에 DB 테이블이 없어서 헤메는 경우가 생겼다! [참고](https://github.com/jojoldu/freelec-springboot2-webservice/issues/275)
      
      
모든 설정값을 입력했으면, **[완료]** 클릭 -> 생성 끝!
